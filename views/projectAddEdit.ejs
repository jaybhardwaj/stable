<!DOCTYPE html>
<html lang="en">

<head>
<style>

.marginAlign{
  margin-top: 2%;
}
.editprojectinputs>div{
    min-height:70px;
    margin-bottom: 20px;
}    
 input[type=number]::-webkit-inner-spin-button, 
input[type=number]::-webkit-outer-spin-button { 
  -webkit-appearance: none; 
  margin: 0; 
}
sup {color: red;}
div .ui-tagger-menu .ui-widget .ui-widget-content .ui-corner-all{}
.ui-tagger
{
  width:100% !important;
  background-color: #FFFFFF !important;
  margin-top: 15px !important;
}
.ui-tagger-menu 
{
width:24% !important;
}
   .form-table label {
          display: inline-block;
          margin: 0 0 -1px;
          padding: 5%;
          font-weight: 600;
          text-align: center;
          color: #524A4A;
          border: 1px solid transparent;
          font-size: 11px;
      }

      .modal-header {
    min-height: 16.43px;
    padding: 15px;
    border-bottom: 1px solid #e5e5e5;
     background-color: #FFFFFF !important;
    height: 40px;
    }
</style>

<% include ./partials/head %>  

</head>
<body>
  <div>
    <% include ./partials/adminheader %>
    <% include ./partials/setting-header %>
  </div>

  <div class="se-pre-con"></div>

  <div id="ModalAdd"></div>
  <div id="ModalAddMesage"></div>
  <div class="container-fluid user-list secondry-color" style=" ">
    <div  style="margin-top:1%">
    <span title="Go To project List" onclick="document.location.href='/projectDetails';" style="float:left;width: 25px;height: 30px;font-size: 20px;color:green;"  class="glyphicon glyphicon-arrow-left"></span>
      <span class="modal-title" style="margin-left:42%"><%if(flag==0){%>Add Project Details<%} else{%>Edit Project Details.<%}%></span> </div>
      <main>
        
      <input type="hidden" id="tabDetail" name="tabDetail">
      <input type="hidden" id="pid" name="pid" <%if(flag==1){%>value='<%=name[0].id%>' <%} else{%> value=0 <%}%>>
      <input type="hidden" id="hdnId" name="hdnId" <%if(flag==1){ %>value='<%=flag%>' <%} else{%> value=0 <%}%>> 
      <input id="tab1" class="tabradio" type="radio" name="tabs" value="1" onclick="handleClick(this);" checked> <label for="tab1">Basic Details</label> 
       <input id="tab2" class="tabradio" type="radio" name="tabs" value="2" onclick="handleClick(this);" > 
       <label for="tab2">Project Data</label>
      <input id="tab5" class="tabradio"   type="radio" name="tabs" value="3" onclick="handleClick(this);" > 
      <label for="tab5">Billing</label>

      <section id="content1">
      <div class="col-md-12">  
      <div class="row fusion-form-elements">
          <div class="col-lg-3 col-md-3 col-sm-4">
            <label>Project Name:<sup  class="astrick">*</sup></label>
            <input type="text"   placeholder=" Enter Project Name " class="form-control input-sm"  style=""  name="pname" id ="idpname" maxlength="50" onblur=" return allProjects(); " <%if(flag==1){%>value='<%=name[0].projectTitle%>'<%}%>>
                <div class="fLeft"><span class="error" id="errorIdpname"></span></div>
          </div>

          <div class="col-lg-3 col-md-3 col-sm-4">
            <label>Project Code:</label>
            <input type="text" style="" class="form-control input-sm" placeholder="Project Code" name="pcode" id ="pcode" onkeypress="return specialchar(event)" <%if(flag==1){%>value='<%=name[0].pcode%>' <%}%> readonly>
                <div class="fLeft"><span class="error" id="errorPcode"></span></div>
          </div>
          <div class="col-lg-3 col-md-3 col-sm-4">
            <label>Client:<sup  class="astrick">*</sup></label>
            <select  class="form-control input-sm" style=""  name="pclient" id ="pclient" onchange="getSelectedOptions($('#pclient :selected').val())"> 
              <option value='0' disabled selected>Select</option>
                  <% for(var i=0;i<client.length;i++) {%>
                <option value="<%=client[i].id%>"><%=client[i].clientName%></option>
                 <%}%>
              </select>
              <div class="fLeft"><span class="error" id="errorPclient"></span></div>
          </div>
          <div class="col-lg-3 col-md-3 col-sm-4">
            <label>Client Contact Person:</label>
              <div id="contactDiv">
                <select multiple="multiple" class="form-control input-sm chosen-select" style=""  name="ccontact" id ="ccontact"> 
                </select> 
                <div class="fLeft"><span class="error" id="errorCcontact"></span></div>
              </div>
          </div>
         </div> 
         <div class="row fusion-form-elements">
          <div class="col-lg-3 col-md-3 col-sm-4">
            <label>Technology:<sup  class="astrick">*</sup></label>
            <select multiple="multiple" class="form-control input-sm chosen-select" style="" name="ptech" id ="ptech" maxlength="50" data-placeholder="Choose Project Technology..."> 
              <option  value='0' disabled selected>Select</option>
                <% for(var i=0;i<tech.length;i++) {%>
                <option value="<%=tech[i].id%>"><%=tech[i].description1%></option>
                      <%}%>
              </select>
              <div class="fLeft"><span class="error" id="errorPtech"></span></div>
          </div>
          <div class="col-lg-3 col-md-3 col-sm-4">
            <label>Planned Start Date:<sup  class="astrick">*</sup></label>
            <input type="text" maxlength="20" placeholder="Select Date"  style=""   class= "form-control input-sm" id="datepicker" name="psdate" <%if(flag==1){%>value='<%=name[0].plannedStartDate%>'<%}%>>
                <div class="fLeft"><span class="error" id="errorDatepicker"></span></div>
          </div>

          <div class="col-lg-3 col-md-3 col-sm-4">
            <label>Planned End Date:<sup  class="astrick">*</sup></label>
            <input type="text" style=""  maxlength="20" placeholder="Select Date" name="pedate"  class="form-control input-sm" id ="datepicker1" <%if(flag==1){%>value='<%=name[0].plannedEndDate%>'  <%}%> >
                <div class="fLeft"><span class="error" id="errorDatepicker1"></span></div>
          </div>
          <div class="col-lg-3 col-md-3 col-sm-4">
            <label>Complexity:</label>
            <select style="" class="form-control input-sm chosen-select" id ="pcomplexity" name="pcomplexity" >
                <option  value='0' disabled selected>Select</option>
                <option  value='simple'<%if(flag==1&&name[0].pcomplexity=='simple'){%>selected<%}%> > simple </option>
                <option  value='medium'<%if(flag==1&&name[0].pcomplexity=='medium'){%>selected<%}%> > medium </option>
                <option  value='complex'<%if(flag==1&&name[0].pcomplexity=='complex'){%>selected<%}%>> complex </option>
              </select>
              <div class="fLeft"><span class="error" id="errorPcomplexity"></span></div>
          </div>
          </div> 
          <div class="row fusion-form-elements">
          <div class="col-lg-3 col-md-3 col-sm-4">
            <label>Location:</label>
            <select class="form-control input-sm chosen-select" id ="plocation" name="plocation" >
                <option value='0' disabled selected >Select</option>
                  <% for(var i=0;i<location.length;i++) {%>
                <option value="<%=location[i].id%>"<%if(flag==1&&name[0].locid==location[i].id){%>selected<%}%> ><%=location[i].location%></option>
                  <%}%>
              </select>
              <div class="fLeft"><span class="error" id="errorPlocation"></span></div>
          </div>
          <div class="col-lg-3 col-md-3 col-sm-4">
            <label>Description:</label>
            <textarea placeholder="Enter Project Description" id="DescriptionID" style="" class="form-control input-sm" row=2 name="pdescription" maxlength="250" onkeypress="return specialchar2(event)" <%if(flag==1){%>value="<%=name[0].description%><%}%>"><%if(flag==1){%><%=name[0].description%><%}%></textarea> 
             <div class="fLeft"><span class="error" id="errorDescriptionID"></span></div> 
          </div>

          <div class="col-lg-3 col-md-3 col-sm-4 "<%if(flag==0 ){%> style="display:none"<%}%> >
            <label>Status:</label><br>
            <input type="radio" name="pstatus"  value= 1  id = "pstatus1" required  style="margin-top:3%" checkded="true"> Active
             &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <input type="radio" name="pstatus"  value= 0  id = "pstatus2" required  style="margin-top:3%;"> Inactive

          </div>
         </div> 

      </div>


<div class="text-center"><span class="success" id="successProjectAddEdit"></span><span class="error" id="errorProjectAddEdit"></span></div>
<script>
  $("#pclient").val([<%if(flag==1){for(var i=0;i<name.length;i++){%>"<%=name[i].cname%>",<%}}%>]).prop("selected", false);
  $("#ptech").val([<%if(flag==1){for(var i=0;i<name.length;i++){%>"<%=name[i].technologyId%>",<%}}%>]).prop("selected", false);
</script> 
          <center  style="margin-bottom:1% "> 
        <a href="/projectDetails">
          <input type="button" name="cancel" value="Cancel" form="cancelform" class="btn btn-primary" style="background-color: #f05f40">
          </a>
         
          <input type="submit"  id="createProject" value="Submit"  onclick="validBasicInfo1()" name="submit" class="btn btn-primary" style="background-color: #f05f40;">

          <input type="button"  value="Next"  onclick="validDocInfo(2)" class="btn btn-primary" style="background-color: #f05f40;">
        
           
          </center>
         
      </section>
      <section id="content2">
        <div class="row">
          <div class="hide" id="select1"><button class="btn btn-primary" id="selectAll">Select All</button></div>
          <div class="hide" id="select2"><button class="btn btn-primary"  id="selectNone">Select None</button></div>
        </div>
      <div class="row fusion-form-elements">
          <div class="col-lg-3 col-md-3 col-sm-4">
            <label>Actual Start Date :</label>
            <input type="text"  maxlength="20" placeholder="Select Actual Start Date"  class= "form-control input-sm" id="datepicker2" style="" name="asdate" <%if(flag==1){if(name[0].actualStartDate !='00/00/00'){%>value='<%=name[0].actualStartDate%>' <%} else{%> value='' <%}}%> >
          </div>  
          <div class="col-lg-3 col-md-3 col-sm-4">
            <label>Actual End Date:</label>
            <input type="text"  maxlength="20" placeholder="  Select Actual End Date" class= "form-control input-sm" id="datepicker3" style="" name="aedate"  <%if(flag==1){if(name[0].actualEndDate !='00/00/00'){%>value='<%=name[0].actualEndDate%>' <%} else{%> value='' <%}}%> >
          </div>
          <div class="col-lg-3 col-md-3 col-sm-4">
            <label>Comercial Head :</label>
            <select class="form-control input-sm chosen-select1" id="pcommercialhead" name="pcommercialhead" >
                <option   value='0' disabled selected>Select</option>
                <% for(var i=0;i<teamlead.length;i++) {%>
                <option value="<%=teamlead[i].id%>"<%if(flag==1&&name[0].commercialHead==teamlead[i].id){%>selected<%}%> ><%=teamlead[i].name%></option>
                  <%}%> 
              </select>
          </div>
          <div class="col-lg-3 col-md-3 col-sm-4">
            <label>Account Lead :</label>
            <select class="form-control input-sm chosen-select1" id="paccounthead" name="paccounthead" >
                <option value='0' selected disabled >Select</option>
                <% for(var i=0;i<teamlead.length;i++) {%>
                <option value="<%=teamlead[i].id%>"<%if(flag==1&&name[0].accountHead==teamlead[i].id){%>selected<%}%> ><%=teamlead[i].name%></option>
                <%}%> </select>
                <div class="fLeft"><span class="error" id="errorPaccounthead"></span></div>
          </div>
          <div class="col-lg-3 col-md-3 col-sm-4">
            <label>Manager :</label>
            <select class="form-control input-sm chosen-select1" id ="pmanager" name="pmanager" >
                <option value='0' selected disabled>Select</option>
                <% for(var i=0;i<manager.length;i++) {%>
                <option value="<%=manager[i].id%>"<%if(flag==1&&name[0].manager==manager[i].id){%>selected<%}%> ><%=manager[i].name%></option>
               <%}%>
              </select>
          </div>
          <div class="col-lg-3 col-md-3 col-sm-4">
            <label>Is Plan Required:</label>
            <select class="form-control input-sm" id ="planReq" name="planReq" >
                <option value="1" selected>Yes</option>
                <option value="0">No</option>
              </select>
          </div>
          <div class="col-lg-3 col-md-3 col-sm-4">
            <label>Assign to All:</label>
            <select style="" id="assign" class="form-control input-sm" name="assign" onclick="AssigntoAll()">
                
                  <option disabled=""  value="2" >Select</option>
                  <option value="1" >Yes</option>
                  <option value="0" selected  >No</option>
                </select>
          </div>
          <div class="col-lg-3 col-md-3 col-sm-4" id="resr">
            <label>Resources:<sup  class="astrick">*</sup></label>
            <div id="presourceDiv">
            <select multiple="multiple" class="form-control input-sm chosen-select1" name="presource" id ="presource" maxlength="50">
                <% for(var i=0;i<resource.length;i++) {%>
                <option value="<%=resource[i].id%>"><%=resource[i].name%></option>
                <%}%>
              </select>
              <%if(flag==1){
                for(var i=0;i<name.length;i++){%>
              
              <%}}%>

              <script type="text/javascript">
                $("#presource").val([<%if(flag==1){for(var i=0;i<name.length;i++){%>"<%=name[i].userId%>",<%}}%>]).prop("selected", false);
                $("#ccontact").val([<%if(flag==1){for(var i=0;i<name.length;i++){ %>"<%=name[i].ccmid%>",<%}}%>]).prop("selected",false);
              </script>
              </div>  
              <div class="fLeft"><span class="error" id="errorPresource"></span></div>
          </div>
       </div>   






       
          <center style="margin-bottom: 1%">
          <a href="/projectDetails">
          <input type="button" name="cancel" value="Cancel" form="cancelform" class="btn btn-primary" style="background-color: #f05f40">
          </a>
          <input type="submit"  id="createProject" value="Submit"  onclick="validBugInfo1()" name="submit" class="btn btn-primary" style="background-color: #f05f40;">


          <input type="button"  value="Next"  onclick="validDocInfo(5)" class="btn btn-primary" style="background-color: #f05f40;">


          </center>
        
      </section>
      <section id="content5">

        <div class="row fusion-form-elements">
          <div class="col-lg-3 col-md-3 col-sm-4">
            <label>Billable:</label> <br>
            <div>
            <input type="radio"   name="isBillable"  value= 1  id = "isBillable1" required  style="margin-top:3%;"> Yes
              &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<input type="radio" name="isBillable"  value= 0  id = "isBillable2" required  style="margin-top:3%;" > No
          </div>
          </div>
          <div class="col-lg-3 col-md-3 col-sm-4">
            <label>Project Type:</label>
            <select style="" id="ptype1" class="form-control input-sm" name="ptype">
                  <option disabled selected value=0>Select</option>
              <% for(var i=0;i<allPtype.length;i++) {%>
              <option value="<%=allPtype[i].id%>"><%=allPtype[i].description1%></option>
              <%}%>
                </select>
          </div>
          <div class="col-lg-3 col-md-3 col-sm-4">
            <label>Tax Code:</label>
            <input type="text" placeholder="Enter Tax Code"  class= "form-control input-sm" id="taxCode" style="" name="taxCode"  maxlength="20"  <%if(flag==1){%>value='<%=name[0].taxCode%>' <%}%>>
          </div>
          <div class="col-lg-3 col-md-3 col-sm-4">
            <label>PO Number:</label>
            <input type="number" class="form-control input-sm" oninput="javascript: if (this.value.length > this.maxLength) this.value = this.value.slice(0, this.maxLength);" maxlength = "10" min = "1" max = "99999" placeholder="  Enter PO Number " id="poNumber" style="" name="poNumber" <%if(flag==1){%>value='<%=name[0].poNumber%>'<%}%> >
          </div>
          <div class="col-lg-3 col-md-3 col-sm-4">
            <label>Project Category:</label>
            <select style="" id="pcat" class="form-control input-sm" name="pcat">
                  <option selected disabled value=0>Select</option>
              <% for(var i=0;i<allPcat.length;i++) {%>
              <option value="<%=allPcat[i].id%>"><%=allPcat[i].description1%></option>
              <%}%>
                </select>
          </div>
        </div>  



            <center style="padding-bottom: 1%">
            <a href="/projectDetails">
          <input type="button" name="cancel" value="Cancel" form="cancelform" class="btn btn-primary" style="background-color: #f05f40">
          </a>
         
          <input type="submit"  id="createProject" value="Submit"  onclick="validFinanceInfo1()" name="submit" class="btn btn-primary" style="background-color: #f05f40;">
         
             </center>

      
        </section>
      </main>
    </div>
  <footer>
    <% include ./partials/footer %>
  </footer> 
</body>

</html>


<script>
  function handleClick(elem){
      if(elem.value ==2){
        $(".chosen-select1").chosen();
      }
      if(elem.value ==3){
        $(".chosen-select2").chosen();
      }
  }
  var tabDisable=0;
  var addedit=0;
  var pressButton=0;
  var abcd=0;
    $(document).ready(function() {
      $(".chosen-select").chosen();

      $('.se-pre-con').fadeOut('slow');

  $("input[name=pstatus][value=" + 1 + "]").prop('checked', true);
  $("input[name=isBillable][value=" + 1 + "]").prop('checked', true);
  $("input[name=ptype][value=" + 1 + "]").prop('checked', true);
  $("input[name=pclient][value=" + 0 + "]").prop('checked', true);
  $('.project-img').addClass('active');

if( '<%=flag%>'=='1'){
         <%if(name.length){%>
           $("input[name=pstatus][value=<%=name[0].pstatus%>]").prop('checked', true);
           $("input[name=isBillable][value=<%=name[0].isBillable%>]").prop('checked', true);

           $('#pcomplexity').val('<%=name[0].pcomplexity%>');
            $('#planReq').val('<%=name[0].isPlanReq%>');

            if ('<%=name[0].assigntoall%>' == '1') {
                        $('#assign').val('<%=name[0].assigntoall%>');
                        $('#presourceDiv').addClass('hide');
                         $('#resr').addClass('hide');
                    } else {
                     
                        $("#assign").val('<%=name[0].assigntoall%>');
                         $('#presourceDiv').removeClass('hide');
                         $('#resr').removeClass('hide');
                    }

if('<%=name[0].projectTitle%>'=='DummyProject'){
        $('#idpname').attr('disabled',true);
      }


      if ('<%=name[0].ptype%>' == null) {
                        $('#ptype1').val(0);
                    } else {
                        $('#ptype1').val('<%=name[0].ptype%>');
                    }
      if ('<%=name[0].category%>' == null) {
          $('#pcat').val(0);
      } else {
          $('#pcat').val('<%=name[0].category%>');
      }
      

    <%}%>

 }
  $("#datepicker").datetimepicker({timepicker:false,format:'m/d/y',scrollMouse: false,scrollInput: false});
  $("#datepicker1").datetimepicker({timepicker:false,format:'m/d/y',scrollMouse: false,scrollInput: false});
  $("#datepicker2").datetimepicker({timepicker:false,format:'m/d/y',scrollMouse: false,scrollInput: false});
  $("#datepicker3").datetimepicker({timepicker:false,format:'m/d/y',scrollMouse: false,scrollInput: false});

if( '<%=flag%>'=='1'){
getSelectedOptions($('#pclient').val());

}

    $('#selectAll').click( function() {
              var string1="<select class='form-text-box chosen-select' name='presource' multiple='multiple' id='presource'><option value=0 disabled>Select </option>" ;

                   <% for(var i=0;i<resource.length;i++) {%>
                
                            string1+="<option value='<%=resource[i].id%>' selected><%=resource[i].name%></option>"  ;           
                       <%}%>
              string1+="</select>";
              $("#presourceDiv").html(string1);
              $(".chosen-select1").chosen();
                  
    });

    $('#selectNone').click( function() {
              var string1="<select class='form-text-box chosen-select' name='presource' multiple='multiple' id='presource'><option value=0 disabled>Select </option>" ;

                   <% for(var i=0;i<resource.length;i++) {%>
                
                            string1+="<option value='<%=resource[i].id%>' ><%=resource[i].name%></option>"  ;           
                       <%}%>
              string1+="</select>";
              $("#presourceDiv").html(string1);
              $(".chosen-select1").chosen();
                   
    });

});

 

    $('#pclient').change(function() {
    }); 

function getSelectedOptions(cid){
  $.ajax({
                url: '/clientContactAccToClient',
                type: 'post',
                data: { "cid": cid},
                success: function(data) {
  
               $("#ccontact").val([<%if(flag==1){for(var i=0;i<name.length;i++){%>"<%=name[i].ccmid%>",<%}}%>]).prop("selected",false);

                  var string1="<select class='chosen-select' multiple='multiple' id=\"ccontact\"><option value=0 disabled>Select </option>" ;
                  var temparr=[];

                   for(var i =0;i<data[0].length;i++){   
                
                        string1+="<option value="+data[0][i].id+" <%if(flag==1){for(var j=0;j<name.length;j++){%>";

                        if(data[0][i].id=='<%=name[j].ccmid%>' && temparr.indexOf('<%=name[j].ccmid%>')<0){
                         
                          string1+='selected';
                          temparr.push('<%=name[j].ccmid%>');

                        }

                        string1+="<%}}%>>"+data[0][i].Name+"</option>"  ;           
                        }
              string1+="</select>";



              $("#contactDiv").html(string1);
                  $(".chosen-select").chosen();
                  
                }

            });
}

    var y = Math.floor((Math.random() * 1000) + 1);
    function myFunction() {
      var x = document.getElementById("idpname");
      var x2 = document.getElementById("pcode");
      if(x.value != ''){
        var ss=x.value;
        ss=ss.charAt(0);
        var s1=x.value;
        s1=s1.charAt(1);
        ss = "".concat(ss,s1);
        x2.value = ss + "_" + y;
      }
      else{
       x2.value="";
      }
    }
    
    function specialCharacter(evt) {
      var charCode = (evt.which) ? evt.which : event.keyCode
      if ((charCode != 38 && charCode > 32 && charCode < 46) || (charCode > 57 && charCode < 64) || charCode == 126 || charCode == 96) {
        alert("This special character or number is not allowed\n ");
        return false;
      }
      return true;
    }
    function allProjects() {
      var abc=1;
              if('<%=flag%>'=='0'){
                <%if(allProjects.length>0){%>
               <%  for(var j=0;j< allProjects.length; j++){%>
                    if($('#idpname').val()=='<%=allProjects[j].projectTitle%>'){
                    alert('Project Already Exists.\nChange the name of project');
                    abc=0;
                    document.getElementById('idpname').value = "";
                    document.getElementById('pcode').value = "";
                     $('#idpname').focus();
                    return false;
                   }
                   else{
                    abc++;
                   }

               <% } } %>
                   if(abc !=0){
                    myFunction();
                    return true;
                   }
                }
    }


    
    function resetUserForm() {
      $("#tab1").click();
      $(".modal input, textarea").val("");
      $(".modal select").val(0);
      $('input[type="radio":checked]').each(function() {
        $(this).checked = false;
      });
      $("#btnuser").text('Create User');
      $("#hdnId").val('0');
    }
            
    function validBasicInfo1() {
      pressButton=1;
      validBasicInfo();
    }
    
    function validBasicInfo() {
    resetError();
      var re="[a-zA-Z ]*$";
      var errorIdpname = $('#errorIdpname');
      var errorPclient = $('#errorPclient');
      var errorPtech = $('#errorPtech');
      var errorDatepicker = $('#errorDatepicker');
      var errorDatepicker1 = $('#errorDatepicker1');

      var idpname=$('#idpname');
      var pclient = $('#pclient');
      var ptech = $('#ptech');
      var datepicker = $('#datepicker');
      var datepicker1 = $('#datepicker1');

      if(idpname.val().trim().length<=0  || idpname.val()==''){
        errorIdpname.text("Required field");
        idpname.focus();
        return false;
      }
      if(pclient.val()==null || pclient.val()=='0')  
      {
        errorPclient.text("Required field");
        pclient.focus();
        return false;
      }
      if(ptech.val()==null || ptech.val()=='0')
      {
        errorPtech.text("Required field"); 
        ptech.focus();
        return false;
      }

        var date = new Date(datepicker.val());
        if(datepicker.val() != ''){
        if(date == 'Invalid Date'){
               errorDatepicker.text('Invalid  Planned Start Date');
               datepicker.focus();
                return false;
            }
          }

         var date = new Date(datepicker1.val());
         if(datepicker1.val() != ''){
         if(date == 'Invalid Date'){
           errorDatepicker1.text('Invalid  Planned End Date');
           datepicker1.focus();
            return false;
          }
        }

              var psdate=new Date(datepicker.val()); var pedate=new Date(datepicker1.val()); 
            if(datepicker.val() == ''){
              errorDatepicker.text('Please Select Planned Start Date');
              datepicker.focus();
              return false;
            }
            if(datepicker1.val() == ''){
              errorDatepicker1.text('Please Select Planned End Date');
              datepicker1.focus();
              return false;
            }
            if(psdate>pedate){
                  errorDatepicker1.text('Planned End Date can not be less than Planned Start Date');

                  return false;
                }


      
      if($('#hdnId').val() == 0){
        if(abcd==0)addedit=0;
      }
      else{
        addedit=1;
      }
      $('#tabDetail').val(1);
        tabDisable=1;
        if(pressButton==1){addProject();}
        else{return true;}
    }
    
    function validBugInfo1() {
      pressButton=2;
      validBugInfo();
    }
    
    function validBugInfo() {
      resetError();
      var errorPresource = $('#errorPresource');
      var abc=validBasicInfo();
      if(abc){
             var text = $('#datepicker2').val();
             var date = new Date(text);

             if(text != ''){
             if(date == 'Invalid Date'){
               alert('Invalid  Actual Start Date');
                return false;
            } }
            var text = $('#datepicker3').val();
             var date = new Date(text);
             if(text != ''){
             if(date == 'Invalid Date'){
               alert('Invalid  Actual End Date');
                return false;
            } }
             var text = $('#datepicker').val();
             var text1 = $('#datepicker1').val();
             var text2 = $('#datepicker2').val();
             var text3 = $('#datepicker3').val();

            var psdate=new Date(text); var pedate=new Date(text1); var asdate=new Date(text2); var aedate=new Date(text3);

            if(text3 != ''){  if (text2 != ''){
              if(asdate>aedate){
                alert('Actual End Date can not be less than Actual Start Date');
                return false;
              }
            }
            else{
              alert('Please Select Actual Start Date');
              return false;
            }
          }

          if($('#presource').val()==null || $('#presource').val()=='0')  
            {
              errorPresource.text("Required field"); 
              $('#presource').focus();
              return false;
            }
              abcd=1;
           if($('#hdnId').val() == 0){
              if(pressButton==2)addedit=1;
              else addedit=1;
           }
           else{
             addedit=1;
              }
              tabDisable=2;
              if(pressButton==2){$('#tabDetail').val(1);addProject();}
              else{$('#tabDetail').val(1);return true;}
            }
          }
          function validFinanceInfo1(){
              pressButton=3;
              validFinanceInfo();
          }
        
            function validFinanceInfo(){
              var abc=validBugInfo();
              if(abc){
                abcd=1;
                if($('#hdnId').val() == 0){
              }
              else{
                addedit=1;
              }
              tabDisable=3;
              if(pressButton==3){addProject();}
              else{return true;}
            }
          }
          function addProject() {

           
                  if($("#pid").val() == 0){
                       addProject1();
                }
                else{
                   $.ajax({
                            url: '/checkProjectWbsDate',
                            type: 'post',
                            data: {"pid": $("#pid").val(), "wid":0, "psdate": $("#datepicker").val(),
                            "pedate": $('#datepicker1').val(),"wpsdate":'0',"wpedate":'0',flag:1
                                  },
                            success: function(data) {
                              
                                if(data[0][0].msg==0){
                                            addProject1();
                                }
                                else{
                                  alert('date validations of project are not according to WBS');
                                }
                            }

                        });
                }
            

            }


            function addProject1(){
                            resetError();
                            var successProjectAddEdit = $('#successProjectAddEdit');
                            var pclient=$("#pclient").val().toString();
                              var ptech=$("#ptech").val().toString();
                              var presource=$("#presource").val()==null?'0':$("#presource").val().toString();
                              var ccontact=$("#ccontact").val()==null?'0':$("#ccontact").val().toString();
                              $.ajax({
                                url: '/projectAddEditDetailsWithFlag',
                                method: 'POST',
                                data: {
                                  "pname": $("#idpname").val(),
                                  "planReq": $("#planReq").val(),
                                  "pclient": pclient,
                                  "presource": presource,
                                  "ccontact":ccontact,
                                  "ptech": ptech,
                                 "pcode": $("#pcode").val(),
                                   "ptype": $('#ptype1').val(),
                                   "pcat": $('#pcat').val(),
                                   "pdescription": $("#DescriptionID").val(),
                                   "psdate": $("#datepicker").val(),
                                  "pedate": $('#datepicker1').val(),
                                  "asdate": $("#datepicker2").val(),
                                   "aedate": $('#datepicker3').val(),
                                   "isBillable": $('input:radio[name=isBillable]:checked').val(),
                                   "taxCode": $('#taxCode').val(),
                                   "poNumber": $('#poNumber').val(),
                                   "pstatus": $('input:radio[name=pstatus]:checked').val(),
                                    "pcomplexity": $('#pcomplexity').val(),
                                    "plocation": $('#plocation').val(),
                                    "pcommercialhead": $('#pcommercialhead').val(),
                                   "paccounthead": $('#paccounthead').val(),
                                   "pmanager": $('#pmanager').val(),
                                    "hdnId": $("#hdnId").val(),
                                    "pid": $("#pid").val(),
                                   "tabDetail":$('#tabDetail').val(),
                                   "assigntoallforproject":$('#assign').val()
                                  },
                                  success: function(data) {
                                   $("#pid").val(data[0][0].lid); 
                                     if(data[0][0].flag == 1){
                                      successProjectAddEdit.text("Successfully Added");
                                    }
                                     else {
                                      successProjectAddEdit.text("Successfully Updated");
                                     }
                                     var check1= '"/projectWbs?pid='+data[0][0].lid+'"';
                                     confirmBox3("window.location.href="+check1,'window.location.href="/projectDetails"',7);
                                  },
                                  dataType: 'JSON',
                                });
            }


            function validDocInfo(prevOrNext) {
              $("#tab" + prevOrNext).click();
             }
function specialCharacter(evt) {
        var charCode = (evt.which) ? evt.which : event.keyCode
        if ((charCode != 38 && charCode > 32 && charCode < 46) || (charCode > 57 && charCode < 64) || charCode == 126 || charCode == 96) {
            alert("This special character or number is not allowed\n ");
            return false;
        }
        return true;
    }


    function AssigntoAll(){
      if($('#assign').val()==1)
     {
       $('#selectAll').click();
      $('#presourceDiv').addClass('hide');

         $('#resr').addClass('hide');
        
        
   } else
    {
      $('#selectNone').click();
      $('#presourceDiv').removeClass('hide');

     $('#resr').removeClass('hide');
        
    }
  }
    
    </script>
